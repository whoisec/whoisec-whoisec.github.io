<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://whoisec.github.io</id>
    <title>WHOISEC  - è‡´åŠ›äºWebå®‰å…¨</title>
    <updated>2022-01-04T06:49:46.350Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://whoisec.github.io"/>
    <link rel="self" href="https://whoisec.github.io/atom.xml"/>
    <subtitle>ğŸ™‹ğŸ»â€â™‚ï¸è¿™é‡Œæ˜¯æˆ‘çš„ä¸ªäººç«™ç‚¹ï¼Œåœ¨è¿™é‡Œè®°å½•å…³äºwebå®‰å…¨çš„å†…å®¹ï¼Œæ¬¢è¿å…³æ³¨ï¼</subtitle>
    <logo>https://whoisec.github.io/images/avatar.png</logo>
    <icon>https://whoisec.github.io/favicon.ico</icon>
    <rights>All rights reserved 2022, WHOISEC  - è‡´åŠ›äºWebå®‰å…¨</rights>
    <entry>
        <title type="html"><![CDATA[nginxé˜²æ­¢SQLæ³¨å…¥ã€XSSæ”»å‡»]]></title>
        <id>https://whoisec.github.io/post/qgLTpfreD/</id>
        <link href="https://whoisec.github.io/post/qgLTpfreD/">
        </link>
        <updated>2022-01-04T06:33:12.000Z</updated>
        <content type="html"><![CDATA[<pre><code class="language-py">if ($request_method !~* GET|POST) { return 444; }
#ä½¿ç”¨444é”™è¯¯ä»£ç å¯ä»¥æ›´åŠ å‡è½»æœåŠ¡å™¨è´Ÿè½½å‹åŠ›ã€‚
#é˜²æ­¢SQLæ³¨å…¥
if ($query_string ~* (\$|'|--|[+|(%20)]union[+|(%20)]|[+|(%20)]insert[+|(%20)]|[+|(%20)]drop[+|(%20)]|[+|(%20)]truncate[+|(%20)]|[+|(%20)]update[+|(%20)]|[+|(%20)]from[+|(%20)]|[+|(%20)]grant[+|(%20)]|[+|(%20)]exec[+|(%20)]|[+|(%20)]where[+|(%20)]|[+|(%20)]select[+|(%20)]|[+|(%20)]and[+|(%20)]|[+|(%20)]or[+|(%20)]|[+|(%20)]count[+|(%20)]|[+|(%20)]exec[+|(%20)]|[+|(%20)]chr[+|(%20)]|[+|(%20)]mid[+|(%20)]|[+|(%20)]like[+|(%20)]|[+|(%20)]iframe[+|(%20)]|[\&lt;|%3c]script[\&gt;|%3e]|javascript|alert|webscan|dbappsecurity|style|confirm\(|innerhtml|innertext)(.*)$) { return 555; }
if ($uri ~* (/~).*) { return 501; }
if ($uri ~* (\\x.)) { return 501; }
#é˜²æ­¢SQLæ³¨å…¥ 
if ($query_string ~* &quot;[;'&lt;&gt;].*&quot;) { return 509; }
if ($request_uri ~ &quot; &quot;) { return 509; }
if ($request_uri ~ (\/\.+)) { return 509; }
if ($request_uri ~ (\.+\/)) { return 509; }

#if ($uri ~* (insert|select|delete|update|count|master|truncate|declare|exec|\*|\')(.*)$ ) { return 503; }
#é˜²æ­¢SQLæ³¨å…¥
if ($request_uri ~* &quot;(cost\()|(concat\()&quot;) { return 504; }
if ($request_uri ~* &quot;[+|(%20)]union[+|(%20)]&quot;) { return 504; }
if ($request_uri ~* &quot;[+|(%20)]and[+|(%20)]&quot;) { return 504; }
if ($request_uri ~* &quot;[+|(%20)]select[+|(%20)]&quot;) { return 504; }
if ($request_uri ~* &quot;[+|(%20)]or[+|(%20)]&quot;) { return 504; }
if ($request_uri ~* &quot;[+|(%20)]delete[+|(%20)]&quot;) { return 504; }
if ($request_uri ~* &quot;[+|(%20)]update[+|(%20)]&quot;) { return 504; }
if ($request_uri ~* &quot;[+|(%20)]insert[+|(%20)]&quot;) { return 504; }
if ($query_string ~ &quot;(&lt;|%3C).*script.*(&gt;|%3E)&quot;) { return 505; }
if ($query_string ~ &quot;GLOBALS(=|\[|\%[0-9A-Z]{0,2})&quot;) { return 505; }
if ($query_string ~ &quot;_REQUEST(=|\[|\%[0-9A-Z]{0,2})&quot;) { return 505; }
if ($query_string ~ &quot;proc/self/environ&quot;) { return 505; }
if ($query_string ~ &quot;mosConfig_[a-zA-Z_]{1,21}(=|\%3D)&quot;) { return 505; }
if ($query_string ~ &quot;base64_(en|de)code\(.*\)&quot;) { return 505; }
if ($query_string ~ &quot;[a-zA-Z0-9_]=http://&quot;) { return 506; }
if ($query_string ~ &quot;[a-zA-Z0-9_]=(\.\.//?)+&quot;) { return 506; }
if ($query_string ~ &quot;[a-zA-Z0-9_]=/([a-z0-9_.]//?)+&quot;) { return 506; }
if ($query_string ~ &quot;b(ultram|unicauca|valium|viagra|vicodin|xanax|ypxaieo)b&quot;) { return 507; }
if ($query_string ~ &quot;b(erections|hoodia|huronriveracres|impotence|levitra|libido)b&quot;) {return 507; }
if ($query_string ~ &quot;b(ambien|bluespill|cialis|cocaine|ejaculation|erectile)b&quot;) { return 507; }
if ($query_string ~ &quot;b(lipitor|phentermin|pro[sz]ac|sandyauer|tramadol|troyhamby)b&quot;) { return 507; }
#è¿™é‡Œå¤§å®¶æ ¹æ®è‡ªå·±æƒ…å†µæ·»åŠ åˆ å‡ä¸Šè¿°åˆ¤æ–­å‚æ•°ï¼ŒcURLã€wgetè¿™ç±»çš„å±è”½æœ‰ç‚¹å„¿æç«¯äº†ï¼Œä½†è¦â€œå®å¯é”™æ€ä¸€åƒï¼Œä¸å¯æ”¾è¿‡ä¸€ä¸ªâ€ã€‚
if ($http_user_agent ~* YisouSpider|ApacheBench|WebBench|Jmeter|JoeDog|Havij|GetRight|TurnitinBot|GrabNet|masscan|mail2000|github|wget|curl|Java|python) { return 508; }
#åŒä¸Šï¼Œå¤§å®¶æ ¹æ®è‡ªå·±ç«™ç‚¹å®é™…æƒ…å†µæ¥æ·»åŠ åˆ å‡ä¸‹é¢çš„å±è”½æ‹¦æˆªå‚æ•°ã€‚
if ($http_user_agent ~* &quot;Go-Ahead-Got-It&quot;) { return 508; }
if ($http_user_agent ~* &quot;GetWeb!&quot;) { return 508; }
if ($http_user_agent ~* &quot;Go!Zilla&quot;) { return 508; }
if ($http_user_agent ~* &quot;Download Demon&quot;) { return 508; }
if ($http_user_agent ~* &quot;Indy Library&quot;) { return 508; }
if ($http_user_agent ~* &quot;libwww-perl&quot;) { return 508; }
if ($http_user_agent ~* &quot;Nmap Scripting Engine&quot;) { return 508; }
if ($http_user_agent ~* &quot;~17ce.com&quot;) { return 508; }
if ($http_user_agent ~* &quot;WebBench*&quot;) { return 508; }
if ($http_user_agent ~* &quot;spider&quot;) { return 508; } #è¿™ä¸ªä¼šå½±å“å›½å†…æŸäº›æœç´¢å¼•æ“çˆ¬è™«ï¼Œæ¯”å¦‚ï¼šæœç‹—
#æ‹¦æˆªå„æ¶æ„è¯·æ±‚çš„UAï¼Œå¯ä»¥é€šè¿‡åˆ†æç«™ç‚¹æ—¥å¿—æ–‡ä»¶æˆ–è€…wafæ—¥å¿—ä½œä¸ºå‚è€ƒé…ç½®ã€‚
if ($http_referer ~* 17ce.com) { return 509; }
#æ‹¦æˆª17ce.comç«™ç‚¹æµ‹é€ŸèŠ‚ç‚¹çš„è¯·æ±‚ï¼Œæ‰€ä»¥æ˜æœˆä¸€ç›´éƒ½è¯´è¿™äº›æµ‹é€Ÿç½‘ç«™çš„æ•°æ®ä»…ä¾›å‚è€ƒä¸èƒ½å½“çœŸçš„ã€‚
if ($http_referer ~* WebBench*&quot;) { return 509; }
#æ‹¦æˆªWebBenchæˆ–è€…ç±»ä¼¼å‹åŠ›æµ‹è¯•å·¥å…·ï¼Œå…¶ä»–å·¥å…·åªéœ€è¦æ›´æ¢åç§°å³å¯ã€‚
</code></pre>
]]></content>
    </entry>
</feed>