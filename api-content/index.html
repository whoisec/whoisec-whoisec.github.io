{"posts":[{"title":"test","content":"&lt;div&gt; Theme by &lt;a href=&quot;https://imhanjie.com/&quot; target=&quot;_blank&quot;&gt;imhanjie&lt;/a&gt;, Powered by &lt;a href=&quot;https://github.com/getgridea/gridea&quot; target=&quot;_blank&quot;&gt;Gridea | &lt;a href=&quot;&lt;%= themeConfig.domain %&gt;/atom.xml&quot; target=&quot;_blank&quot;&gt;RSS&lt;/a&gt;&lt;/a&gt; &lt;/div&gt; ","link":"https://whoisec.github.io/post/aXScZtiDZ/"},{"title":"Nginx防止SQL注入、XSS攻击","content":"if ($request_method !~* GET|POST) { return 444; } #使用444错误代码可以更加减轻服务器负载压力。 #防止SQL注入 if ($query_string ~* (\\$|'|--|[+|(%20)]union[+|(%20)]|[+|(%20)]insert[+|(%20)]|[+|(%20)]drop[+|(%20)]|[+|(%20)]truncate[+|(%20)]|[+|(%20)]update[+|(%20)]|[+|(%20)]from[+|(%20)]|[+|(%20)]grant[+|(%20)]|[+|(%20)]exec[+|(%20)]|[+|(%20)]where[+|(%20)]|[+|(%20)]select[+|(%20)]|[+|(%20)]and[+|(%20)]|[+|(%20)]or[+|(%20)]|[+|(%20)]count[+|(%20)]|[+|(%20)]exec[+|(%20)]|[+|(%20)]chr[+|(%20)]|[+|(%20)]mid[+|(%20)]|[+|(%20)]like[+|(%20)]|[+|(%20)]iframe[+|(%20)]|[\\&lt;|%3c]script[\\&gt;|%3e]|javascript|alert|webscan|dbappsecurity|style|confirm\\(|innerhtml|innertext)(.*)$) { return 555; } if ($uri ~* (/~).*) { return 501; } if ($uri ~* (\\\\x.)) { return 501; } #防止SQL注入 if ($query_string ~* &quot;[;'&lt;&gt;].*&quot;) { return 509; } if ($request_uri ~ &quot; &quot;) { return 509; } if ($request_uri ~ (\\/\\.+)) { return 509; } if ($request_uri ~ (\\.+\\/)) { return 509; } #if ($uri ~* (insert|select|delete|update|count|master|truncate|declare|exec|\\*|\\')(.*)$ ) { return 503; } #防止SQL注入 if ($request_uri ~* &quot;(cost\\()|(concat\\()&quot;) { return 504; } if ($request_uri ~* &quot;[+|(%20)]union[+|(%20)]&quot;) { return 504; } if ($request_uri ~* &quot;[+|(%20)]and[+|(%20)]&quot;) { return 504; } if ($request_uri ~* &quot;[+|(%20)]select[+|(%20)]&quot;) { return 504; } if ($request_uri ~* &quot;[+|(%20)]or[+|(%20)]&quot;) { return 504; } if ($request_uri ~* &quot;[+|(%20)]delete[+|(%20)]&quot;) { return 504; } if ($request_uri ~* &quot;[+|(%20)]update[+|(%20)]&quot;) { return 504; } if ($request_uri ~* &quot;[+|(%20)]insert[+|(%20)]&quot;) { return 504; } if ($query_string ~ &quot;(&lt;|%3C).*script.*(&gt;|%3E)&quot;) { return 505; } if ($query_string ~ &quot;GLOBALS(=|\\[|\\%[0-9A-Z]{0,2})&quot;) { return 505; } if ($query_string ~ &quot;_REQUEST(=|\\[|\\%[0-9A-Z]{0,2})&quot;) { return 505; } if ($query_string ~ &quot;proc/self/environ&quot;) { return 505; } if ($query_string ~ &quot;mosConfig_[a-zA-Z_]{1,21}(=|\\%3D)&quot;) { return 505; } if ($query_string ~ &quot;base64_(en|de)code\\(.*\\)&quot;) { return 505; } if ($query_string ~ &quot;[a-zA-Z0-9_]=http://&quot;) { return 506; } if ($query_string ~ &quot;[a-zA-Z0-9_]=(\\.\\.//?)+&quot;) { return 506; } if ($query_string ~ &quot;[a-zA-Z0-9_]=/([a-z0-9_.]//?)+&quot;) { return 506; } if ($query_string ~ &quot;b(ultram|unicauca|valium|viagra|vicodin|xanax|ypxaieo)b&quot;) { return 507; } if ($query_string ~ &quot;b(erections|hoodia|huronriveracres|impotence|levitra|libido)b&quot;) {return 507; } if ($query_string ~ &quot;b(ambien|bluespill|cialis|cocaine|ejaculation|erectile)b&quot;) { return 507; } if ($query_string ~ &quot;b(lipitor|phentermin|pro[sz]ac|sandyauer|tramadol|troyhamby)b&quot;) { return 507; } #这里大家根据自己情况添加删减上述判断参数，cURL、wget这类的屏蔽有点儿极端了，但要“宁可错杀一千，不可放过一个”。 if ($http_user_agent ~* YisouSpider|ApacheBench|WebBench|Jmeter|JoeDog|Havij|GetRight|TurnitinBot|GrabNet|masscan|mail2000|github|wget|curl|Java|python) { return 508; } #同上，大家根据自己站点实际情况来添加删减下面的屏蔽拦截参数。 if ($http_user_agent ~* &quot;Go-Ahead-Got-It&quot;) { return 508; } if ($http_user_agent ~* &quot;GetWeb!&quot;) { return 508; } if ($http_user_agent ~* &quot;Go!Zilla&quot;) { return 508; } if ($http_user_agent ~* &quot;Download Demon&quot;) { return 508; } if ($http_user_agent ~* &quot;Indy Library&quot;) { return 508; } if ($http_user_agent ~* &quot;libwww-perl&quot;) { return 508; } if ($http_user_agent ~* &quot;Nmap Scripting Engine&quot;) { return 508; } if ($http_user_agent ~* &quot;~17ce.com&quot;) { return 508; } if ($http_user_agent ~* &quot;WebBench*&quot;) { return 508; } if ($http_user_agent ~* &quot;spider&quot;) { return 508; } #这个会影响国内某些搜索引擎爬虫，比如：搜狗 #拦截各恶意请求的UA，可以通过分析站点日志文件或者waf日志作为参考配置。 if ($http_referer ~* 17ce.com) { return 509; } #拦截17ce.com站点测速节点的请求，所以明月一直都说这些测速网站的数据仅供参考不能当真的。 if ($http_referer ~* WebBench*&quot;) { return 509; } #拦截WebBench或者类似压力测试工具，其他工具只需要更换名称即可。 ","link":"https://whoisec.github.io/post/qgLTpfreD/"}]}